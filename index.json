
[{"content":"一些各种各样的 blog 与备忘\n","date":"2025 年 11 月 19 日","externalUrl":null,"permalink":"/index.html","section":"","summary":"","title":"","type":"page"},{"content":"","date":"2025 年 11 月 19 日","externalUrl":null,"permalink":"/posts/index.html","section":"","summary":"","title":"","type":"posts"},{"content":"","date":"2025 年 11 月 19 日","externalUrl":null,"permalink":"/tags/index.html","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"2025 年 11 月 19 日","externalUrl":null,"permalink":"/tags/%E9%87%8F%E5%AD%90%E5%8C%96%E5%AD%A6.html","section":"Tags","summary":"","title":"量子化学","type":"tags"},{"content":"为了处理包含相互作用粒子的体系 (例如原子或分子) 的与不含时薛定谔方程, 必须采用近似方法. 变分法的意义在于能够通过测量体系有限的波函数, 对体系整体的能量与状态进行估计.\n变分理论\r#\r设一个系统的不含时哈密顿算符 $\\hat{H}$ , 其最低能量本征值为 $E_1$. 若 $\\phi$ 是系统粒子坐标的一个归一化且性质良好的波函数, 并满足该系统的边界条件, 则\n$$ \\int \\phi^{*} \\hat{H} \\phi d\\tau \\geq E_1.(1-1) $$即变分定理能够帮助我们计算基态能量的下限.\n变分定理的证明较为简单, 我们通过将波函数 $\\phi$ 使用哈密顿算符 $\\hat{H}$ 的特征完备正交本征函数 $\\psi_i$ 进行展开, 即\n$$ \\phi=\\sum_i a_i \\times \\psi_i,(1-2) $$满足 $\\hat{H} \\psi_i = E_i \\times \\psi_i$. 将(1-2)式带入(1-1)式, 假设(实际上符合数学要求)求和符号可以跟随系数 $a_i$ 和 $a_j$ 挪到积分符号外, 得\n$$ \\int \\phi^{*} \\hat{H} \\phi d\\tau = \\int\\sum_i a_i^{*} \\psi_i^{*} \\hat{H} \\sum_j a_j \\psi_j d\\tau = \\sum_i \\sum_j a_i^{*} a_j\\int \\psi_i^{*} \\hat{H} \\psi_j d\\tau. $$进一步, 应用本征函数的性质, 得:\n$$ \\sum_i \\sum_j a_i^{*} a_j\\int \\psi_i^{*} \\hat{H} \\psi_j d\\tau = \\sum_i \\sum_j a_i^{*} a_j\\int \\psi_i^{*} E_j \\psi_j d\\tau = \\sum_i \\sum_j a_i^{*} a_j E_j \\int \\psi_i^{*} \\psi_j d\\tau. $$因为所选择的本征函数彼此正交, 有 $\\int \\psi_i^{*} \\psi_j d\\tau = \\delta_{ij}$, 且系数 $a_i, a_j$ 都为实数, 有\n$$ \\sum_i \\sum_j a_i^{*} a_j E_j \\int \\psi_i^{*} \\psi_j d\\tau = \\sum_i \\sum_j a_i^{*} a_j E_j \\delta_{ij} = \\sum_j a_j^2 E_j.(1-3) $$因为波函数 $\\phi$ 是归一化的, 根据归一化条件 $\\int \\phi^*\\phi d\\tau=1$, 有\n$$ \\int \\phi^*\\phi d\\tau = \\sum_i \\sum_j a_i^{*} a_j\\int \\psi_i^{*} \\psi_j d\\tau = \\sum_i \\sum_j a_i^{*} a_j \\delta_{ij} = \\sum_j a_j^2 = 1.(1-4) $$将式(1-3), (1-4)代回式(1-1), 有\n$$ \\int \\phi^{*} \\hat{H} \\phi d\\tau = \\sum_j a_j^2 E_j \\geq E_1. $$如果移除波函数 $\\phi$ 已经归一化这个假设条件, 可以给 $\\phi$ 乘一个归一化系数 $k$ 使其归一化, 即$\\int k^* \\phi^* k\\phi d\\tau = 1$. 此时有 $\\int \\phi^*\\phi d\\tau = \\frac{1}{|k|^2}$, 式(1)则变为\n$$ \\frac{\\int \\phi^{*} \\hat{H} \\phi d\\tau}{\\int \\phi^*\\phi d\\tau}\\geq {E_1}. $$为了得到基态能量的良好近似值, 我们会尝试许多不同的 $\\phi$, 并寻找能使变分积分取到最低值的那个函数. 根据式(1-1), 变分积分的值越低, 我们所得到的近似就越精确.\n在实际运用中, 人们通常会将未知参数 $a_i$ 放入已知的函数 $\\psi$ 中以构建未知波函数 $\\phi$, 然后通过调整这些参数来使变分积分达到最小值.\n#对变分函数进行展开 上一部分中, 通过变分定理得到了基态状态能量以及基态波函数. 此时我们考虑激发态, 将激发态能量从低到高依次排列\n$$ E_1\\leq E_2\\leq \\ldots . $$对于归一化的波函数, 变分函数为\n$$ \\int \\phi^{*} \\hat{H} \\phi d\\tau = \\sum_i a_i^2 E_i , \\int \\phi^{*} \\phi d\\tau = \\sum_i a_i^2 = 1. $$考虑第一激发态, 能量为$E_2$. 如果想类似上文一样应用变分函数得到下界, 则需要使基态能量消失, 即 $a_1 = 0$. 而什么时候 $a_1 = 0$ 成立呢? 通过上文的推导过程可以得知 $\\langle \\psi_1|\\phi \\rangle = 0$, 即 $\\int \\psi_1^* \\phi d\\tau = 0$ 时, $a_1 = 0 $ 成立. 推导过程省略, 重复上文步骤即可验证.此时\n以此类推, $\\langle \\psi_1|\\phi \\rangle = 0$, 且 $\\langle \\psi_2|\\phi \\rangle = 0 $ 时, 有 $\\int \\phi^{*} \\hat{H} \\phi d\\tau\\geq E_2.$\n当 $\\langle \\psi_1|\\phi \\rangle = 0, \\langle \\psi_2|\\phi \\rangle = 0 , \\langle \\psi_3|\\phi \\rangle = 0$ 时, 有 $\\int \\phi^{*} \\hat{H} \\phi d\\tau\\geq E_4$ 等.\n线性变分函数与久期方程\r#\r在分子研究中广泛使用的一种特殊变分函数是线性变分函数, 目标函数, 即线性所求波函数的本征函数是由 $n$ 个已知的线性无关函数 $f_i$ 的线性组合构成的.\n$$ \\phi = \\sum_i^n c_i f_i $$可以注意到此时线性变分函数使用的基函数 $f_i$ 已经无需是波函数 $\\phi$ 的本征函数了, 但依然需要满足边界条件. 额外假设 $f_i$ 是实函数, $c_i$ 是实数. 此时进行与变分定理类似的推导\n$$ \\int \\phi^{*} \\hat{H} \\phi d\\tau = \\int \\sum_i^n c_i^* f_i^* \\hat{H} \\sum_j^n c_j f_j d\\tau = \\sum_i^n \\sum_j^n c_i^* c_j \\int f_i^* \\hat{H} f_j d\\tau. $$$$ \\int \\phi^{*} \\phi d\\tau = \\int \\sum_i^n c_i^* f_i^* \\sum_j^n c_j f_j d\\tau = \\sum_i^n \\sum_j^n c_i^* c_j \\int f_i^* f_j d\\tau. $$记 $\\int f_i^* \\hat{H} f_j d\\tau$ 为 $H_{ij}$, $\\int f_i^* f_j d\\tau$为 $S_{ij}$.\n记 $W$为\n$$ W=\\frac{\\int \\phi^{*} \\hat{H} \\phi d\\tau}{\\int \\phi^{*} \\phi d\\tau}=\\frac{\\sum_i^n \\sum_j^n c_i^* c_j H_{ij}}{\\sum_i^n \\sum_j^n c_i^* c_j S_{ij}}. $$此时有\n$$ W\\times \\sum_i^n \\sum_j^n c_i^* c_j S_{ij} = \\sum_i^n \\sum_j^n c_i^* c_j H_{ij}. (2-1) $$$W$ 作为 $c_1, c_2, \\ldots ,c_n$ 的函数, 可以通过使 $W$ 对各个系数的一阶偏导为 $0$ 求得最小值(与此同时 $W\\geq E_1$ ), 即\n$$ \\frac{\\partial W}{\\partial c_k} = 0,\\qquad k = 1, 2, \\ldots, n. $$对式 (2-1) 两边对 $c_i$ 求偏导\n$$ \\frac{\\partial W}{\\partial c_k}\\sum_i^n\\sum_j^n c_i^* c_j S_{ij} + W \\frac{\\partial }{\\partial c_k}\\sum_i^n\\sum_j^n c_i^* c_j S_{ij} = \\frac{\\partial }{\\partial c_k}\\sum_i^n\\sum_j^n c_i^* c_j H_{ij}, \\quad k = 1, 2,\\ldots,n. $$偏导符号可以移动到求和符号内部, 且因为 $c_i$ 均为实数, 有 $c_i^*=c_i$, 且因为要求最小值, $\\frac{\\partial W}{\\partial c_k} = 0$ 自动成立\n$$ W \\sum_i^n\\sum_j^n \\frac{\\partial }{\\partial c_k} c_i c_j S_{ij} = \\sum_i^n\\sum_j^n \\frac{\\partial }{\\partial c_k} c_i c_j H_{ij}, \\quad k = 1, 2,\\ldots,n. $$此时对于求和内部的 $\\frac{\\partial }{\\partial c_k} c_i c_j$, 只有当 $k = i$ 或 $k = j$ 时才能有值, 而当 $k=i=j$ 时被记两遍, 所以系数为 $2$ 有\n$$ 2W \\sum_i^n c_i S_{ki} = 2\\sum_i^n c_i H_{ki}, \\quad k = 1, 2,\\ldots,n. $$移一下项\n$$ \\sum_i^n c_i (H_{ki} - W\\times S_{ki}) = 0, \\quad k = 1, 2,\\ldots,n. $$此时变成 $n$ 个方程组成的 $n$ 维其次线性方程组如下\n$$ \\begin{align*} c_1 (H_{11} - W\\times S_{11}) + c_2(H_{12} - W\\times S_{12}) + \\ldots + c_2(H_{1n} - W\\times S_{1n}) \u0026= 0\\\\ c_1 (H_{21} - W\\times S_{21}) + c_2(H_{22} - W\\times S_{22}) + \\ldots + c_2(H_{2n} - W\\times S_{2n}) \u0026= 0\\\\ ...................................................................\u0026.....\\\\ c_1 (H_{n1} - W\\times S_{n1}) + c_2(H_{n2} - W\\times S_{n2}) + \\ldots + c_2(H_{nn} - W\\times S_{nn}) \u0026= 0 \\end{align*} $$这个线性方程组可以被写成矩阵形式\n$$ \\left( \\begin{matrix} H_{11} - W\\times S_{11} \u0026 H_{12} - W\\times S_{12} \u0026 \\cdots \u0026 H_{1n} - W\\times S_{1n}\\\\ H_{21} - W\\times S_{21} \u0026 H_{22} - W\\times S_{22} \u0026 \\cdots \u0026 H_{2n} - W\\times S_{2n}\\\\ \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots\\\\ H_{n1} - W\\times S_{n1} \u0026 H_{n2} - W\\times S_{n2} \u0026 \\cdots \u0026 H_{nn} - W\\times S_{nn} \\end{matrix} \\right)\\times \\left( \\begin{matrix} c_1\\\\ c_2\\\\ \\vdots\\\\ c_n \\end{matrix} \\right)= \\left( \\begin{matrix} 0\\\\ 0\\\\ \\vdots\\\\ 0 \\end{matrix} \\right).(2-2) $$因为这是 $n$ 个方程组成的 $n$ 维其次线性方程组, 其有非零解的条件是系数行列式 $det(H_{ij} - W\\times S_{ij})$ 为零, 即\n$$ \\left[ \\begin{matrix} H_{11} - W\\times S_{11} \u0026 H_{12} - W\\times S_{12} \u0026 \\cdots \u0026 H_{1n} - W\\times S_{1n}\\\\ H_{21} - W\\times S_{21} \u0026 H_{22} - W\\times S_{22} \u0026 \\cdots \u0026 H_{2n} - W\\times S_{2n}\\\\ \\vdots \u0026 \\vdots \u0026 \\vdots \u0026 \\vdots\\\\ H_{n1} - W\\times S_{n1} \u0026 H_{n2} - W\\times S_{n2} \u0026 \\cdots \u0026 H_{nn} - W\\times S_{nn} \\end{matrix} \\right]=0.(2-3) $$式(2-3)被称为久期方程. 由代数知识可知, 这个行列式是一个关于 $W$ 的 $n$ 次方程, 可以解得 $n$ 个 $W$. 将其从小到大排列\n$$ W_1\\leq W_2\\leq W_3\\leq \\ldots \\leq W_n. $$式(2-2)可以解出当 $W$ 最小时的 $c_1, c_2,\\ldots, c_n$. 根据 $c_1, c_2,\\ldots, c_n$ 可以组合出 基态和 $n-1$ 个激发态的能量, 将其从小到大排列\n$$ E_1\\leq E_2\\leq E_3\\leq \\ldots \\leq E_n. $$已经有证明[J. K. L. MacDonald, Phys. Rev., 43, 830 (1933); R. H. Young, Int. J. Quantum Chem., 6, 596 (1972)],\n$$ E_1\\leq W_1,\\quad E_2\\leq W_2,\\quad E_3\\leq W_3,\\quad \\ldots,\\quad E_n\\leq W_n. $$如果这些函数构成一个完备集, 那么我们就能得到该系统的真正波函数. 然而, 通常我们需要无穷多个函数才能形成一个完备集.\n为了得到基态波函数的近似值, 我们取久期方程的最小根 $W_1$, 并将其代入方程 (2-2) 中. 然后求解方程, 能够得到一组系数 $c_1^1, c_2^1,\\ldots, c_n^1$. 上标 $i$ 表示这组系数是通过带入 $W_i$ 确定的. 然而因为式 (2-3) 表明行列式的值为 $0$, 可以确定有方程没有发挥作用, 所以无法得到这一组数据的精确值, 只能得到其比率. 幸运的是, 我们还有一个归一化条件可以使用. 这样就可以得到 $\\phi_1=\\sum_i^n c_i f_i$ 作为一个近似的基态波函数, 类似地用索引更高的根 $W_i$ 可以计算出激发态的波函数. 有证明这 $n$ 个近似基态波函数是相互正交的.\n","date":"2025 年 11 月 19 日","externalUrl":null,"permalink":"/posts/variation_method_and_secular_equation/context1.html","section":"","summary":"","title":"量子化学中变分法与久期方程的推导","type":"posts"},{"content":"","date":"2025 年 11 月 18 日","externalUrl":null,"permalink":"/tags/gromacs.html","section":"Tags","summary":"","title":"Gromacs","type":"tags"},{"content":"rmsd 是通过分析轨迹中结构与参照结构位置偏移量的均方根, 以判断轨迹中构象是否稳定的参数.\n而 mdrun 生成的 md.xtc 轨迹与参照的初始结构 md.tpr 并未进行 PBC 的处理, 假定盒子的 x 轴为 0-16, 因此靠近右侧边界的分子会有一部分原子的 x 坐标为 1 左右.\n如果直接使用\ngmx rms -s md.tpr -f md.xtc -o rmsd.xvg -tu ps 进行 RMSD 分析, 会得到一个这样的图像. 这样的结果显然是有问题的. 因为在变化的过程中原子可能会穿越边界, x 坐标从接近 16 突变为 1 左右, 而参考结构中该原子的坐标为接近 16 的数值, 此时的 RMSD 图像会有一个突变的过程.\n如果使用\ngmx trjconv -s md.tpr -f md.xtc -o md_noPBC.xtc -pbc mol 对轨迹进行处理, 再使用\ngmx rms -s md.tpr -f md_noPBC.xtc -o rmsd_noPBC_mol.xvg -tu ps 生成 rmsd 图像如下 其中蓝色的线表示原始的 RMSD, 红色的线表示处理 PBC 之后的轨迹的 RMSD.\n此时的问题在于 RMSD 的初始值不是 0. 原因在于作为参照的初始结构并未进行 pbc 处理, 即参照结构的右侧分子的部分原子在盒子左侧, 但轨迹中的该原子被修正到了盒子右侧之外.\n使用\ngmx trjconv -s md.tpr -f md_noPBC1.xtc -o reference_noPBC1.gro -b 0 -e 0 获取轨迹中第 0 帧作为参照, 得到图像 现在 RMSD 的起点变为 0 了. 但过程中依旧存在突变, 因为使用-pbc mol修正周期性后, 若分子的质心跨过盒子边界, 依然会出现在盒子另一侧.\n如果使用-pbc nojump参数, 能够保证聚合物不会出现跨越盒子边界的情况, 使用上述方法可以得到图像 在最后得到了很好的收敛.\n然而分析轨迹发现, 使用-pbc nojump得到的轨迹是初始在某一盒子内的 6 条聚合物的相互作用, 并不能反映除了稳定构象以外的其他东西.\n结论是, 判断是否达到平衡可以使用-pbc mol参数得到的轨迹对比第一帧的结构进行判断, 而对于氢键, 能量等数据似乎还是需要使用-pbc mol参数, 在特定盒子内进行研究.\n","date":"2025 年 11 月 18 日","externalUrl":null,"permalink":"/posts/trjconv_and_rmsd/context.html","section":"","summary":"","title":"trjconv中pbc参数对RMSD的影响","type":"posts"},{"content":"","date":"2025 年 11 月 18 日","externalUrl":null,"permalink":"/tags/%E5%88%86%E5%AD%90%E6%A8%A1%E6%8B%9F.html","section":"Tags","summary":"","title":"分子模拟","type":"tags"},{"content":"","externalUrl":null,"permalink":"/about.html","section":"","summary":"","title":"","type":"page"},{"content":"","externalUrl":null,"permalink":"/authors/index.html","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/index.html","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/series/index.html","section":"Series","summary":"","title":"Series","type":"series"}]