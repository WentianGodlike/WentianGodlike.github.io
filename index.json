
[{"content":"11111\n","date":"2025 年 11 月 19 日","externalUrl":null,"permalink":"/index.html","section":"","summary":"","title":"","type":"page"},{"content":"","date":"2025 年 11 月 19 日","externalUrl":null,"permalink":"/posts/index.html","section":"","summary":"","title":"","type":"posts"},{"content":"rmsd 是通过分析轨迹中结构与参照结构位置偏移量的均方根, 以判断轨迹中构象是否稳定的参数.\n而 mdrun 生成的 md.xtc 轨迹与参照的初始结构 md.tpr 并未进行 PBC 的处理, 假定盒子的 x 轴为 0-16, 因此靠近右侧边界的分子会有一部分原子的 x 坐标为 1 左右.\n如果直接使用\ngmx rms -s md.tpr -f md.xtc -o rmsd.xvg -tu ps 进行 RMSD 分析, 会得到一个这样的图像. 这样的结果显然是有问题的. 因为在变化的过程中原子可能会穿越边界, x 坐标从接近 16 突变为 1 左右, 而参考结构中该原子的坐标为接近 16 的数值, 此时的 RMSD 图像会有一个突变的过程.\n如果使用\ngmx trjconv -s md.tpr -f md.xtc -o md_noPBC.xtc -pbc mol 对轨迹进行处理, 再使用\ngmx rms -s md.tpr -f md_noPBC.xtc -o rmsd_noPBC_mol.xvg -tu ps 生成 rmsd 图像如下 其中蓝色的线表示原始的 RMSD, 红色的线表示处理 PBC 之后的轨迹的 RMSD.\n此时的问题在于 RMSD 的初始值不是 0. 原因在于作为参照的初始结构并未进行 pbc 处理, 即参照结构的右侧分子的部分原子在盒子左侧, 但轨迹中的该原子被修正到了盒子右侧之外.\n使用\ngmx trjconv -s md.tpr -f md_noPBC1.xtc -o reference_noPBC1.gro -b 0 -e 0 获取轨迹中第 0 帧作为参照, 得到图像 现在 RMSD 的起点变为 0 了. 但过程中依旧存在突变, 因为使用-pbc mol修正周期性后, 若分子的质心跨过盒子边界, 依然会出现在盒子另一侧.\n如果使用-pbc nojump参数, 能够保证聚合物不会出现跨越盒子边界的情况, 使用上述方法可以得到图像 在最后得到了很好的收敛.\n然而分析轨迹发现, 使用-pbc nojump得到的轨迹是初始在某一盒子内的 6 条聚合物的相互作用, 并不能反映除了稳定构象以外的其他东西.\n结论是, 判断是否达到平衡可以使用-pbc mol参数得到的轨迹对比第一帧的结构进行判断, 而对于氢键, 能量等数据似乎还是需要使用-pbc mol参数, 在特定盒子内进行研究.\n","date":"2025 年 11 月 18 日","externalUrl":null,"permalink":"/posts/trjconv_and_rmsd/context.html","section":"","summary":"","title":"trjconv中pbc参数对RMSD的影响","type":"posts"},{"content":"","externalUrl":null,"permalink":"/about.html","section":"","summary":"","title":"","type":"page"},{"content":"","externalUrl":null,"permalink":"/authors/index.html","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","externalUrl":null,"permalink":"/categories/index.html","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","externalUrl":null,"permalink":"/series/index.html","section":"Series","summary":"","title":"Series","type":"series"},{"content":"","externalUrl":null,"permalink":"/tags/index.html","section":"Tags","summary":"","title":"Tags","type":"tags"}]